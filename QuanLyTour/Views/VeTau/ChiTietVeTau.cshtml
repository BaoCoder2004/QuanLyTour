@using X.PagedList.Mvc.Core
@model QuanLyTour.Models.DetailViewModel
@{
    ViewData["Title"] = "Thông tin đặt vé";
    Layout = "~/Views/Shared/_Detail.cshtml";
    <!-- jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <!-- Bootstrap 3.3.7 JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    
}
<!--===== INNERPAGE-WRAPPER ====-->
<!-- Search Container -->
<!-- Search Container -->
<div class="search-container">
    <div class="container">
        <div class="search-form">
            <div class="form-section">
                <div class="trip-type">
                    <div class="trip-option active" id="oneWay">Một chiều</div>
                    <div class="trip-option" id="roundTrip">Khứ hồi</div>
                </div>

                <div class="row">
                    <div class="col-md-4">
                        <div class="form-group">
                            <label>Chọn chiều đi</label>
                            <div class="direction-selection">
                                <div class="station-selector">
                                    <i class="fa fa-train"></i>
                                    <select class="form-control" id="departureStation">
                                        <option value="HNO" selected>Hà Nội (HNO)</option>
                                        <option value="SGO">Sài Gòn (SGO)</option>
                                        <option value="DAG">Đà Nẵng (DAG)</option>
                                        <option value="NTR">Nha Trang (NTR)</option>
                                        <option value="LCA">Lào Cai (LCA)</option>
                                    </select>
                                </div>
                                <button class="swap-btn" id="swapStations">
                                    <i class="fa fa-exchange"></i>
                                </button>
                                <div class="station-selector">
                                    <i class="fa fa-train"></i>
                                    <select class="form-control" id="arrivalStation">
                                        <option value="LCA" selected>Lào Cai (LCA)</option>
                                        <option value="HNO">Hà Nội (HNO)</option>
                                        <option value="SGO">Sài Gòn (SGO)</option>
                                        <option value="DAG">Đà Nẵng (DAG)</option>
                                        <option value="NTR">Nha Trang (NTR)</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-3">
                        <div class="form-group">
                            <label>Ngày đi</label>
                            <div class="date-input">
                                <input type="date" class="form-control" id="departDate">
                            </div>
                        </div>
                    </div>

                    <div class="col-md-3">
                        <div class="form-group">
                            <label>Ngày về (Khứ hồi)</label>
                            <div class="date-input">
                                <input type="date" class="form-control" id="returnDate" placeholder="Chọn nếu mua vé về" disabled>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-2">
                        <div class="form-group">
                            <label>Hành khách</label>
                            <div class="passenger-selector">
                                <button type="button" class="btn btn-default" id="decreasePassenger">-</button>
                                <input type="text" id="passengerCount" value="1" readonly class="form-control text-center" style="width: 50px; height:34px; display: inline-block;">
                                <button type="button" class="btn btn-default" id="increasePassenger">+</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-offset-10 col-md-2">
                    <button class="btn btn-search">Tìm</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Results Container -->
<div class="results-container">
    <div class="container">
        <!-- Results Header -->
        <div class="results-header">
            <h2 class="results-title">Chọn chiều đi</h2>
            <div class="route-display">Hà Nội → Lào Cai</div>
        </div>

        <!-- Month/Year Selector -->
        <div class="month-year-selector">
            <div class="row">
                <div class="col-md-4">
                    <label>Tháng</label>
                    <select id="monthSelector" class="form-control">
                        <!-- Options will be added by JavaScript -->
                    </select>
                </div>
                <div class="col-md-4">
                    <label>Năm</label>
                    <select id="yearSelector" class="form-control">
                        <!-- Options will be added by JavaScript -->
                    </select>
                </div>
                <div class="col-md-4">
                    <label>&nbsp;</label>
                    <button id="goToDateBtn" class="btn btn-default form-control">Đi đến tháng được chọn</button>
                </div>
            </div>
        </div>

        <!-- Date Navigation -->
        <div class="date-navigation">
            <div class="date-scroll-wrapper">
                <button class="date-scroll-btn left">
                    <i class="fa fa-chevron-left"></i>
                </button>
                <div class="date-options" id="dateOptions">
                    <!-- Date options will be added dynamically by JavaScript -->
                </div>
                <button class="date-scroll-btn right">
                    <i class="fa fa-chevron-right"></i>
                </button>
            </div>
        </div>

        <!-- Train Options -->
        <!-- SP3 Train Option -->
        <div class="train-option">
            <div class="row">
                <div class="col-md-2">
                    <div class="train-details">
                        <div class="train-type">Tàu chất lượng cao</div>
                        <div class="train-code">SP3</div>
                        <div class="seats-available">Còn 86 chỗ</div>
                    </div>
                </div>

                <div class="col-md-2">
                    <div class="station-info">
                        <div class="station-name">Ga Hà Nội</div>
                        <div class="time">06:00</div>
                        <div class="date-display">24 tháng 03</div>
                    </div>
                </div>

                <div class="col-md-2">
                    <div class="journey-visualization">
                        <div class="duration">8h10p</div>
                        <div class="arrow">→</div>
                    </div>
                </div>

                <div class="col-md-2">
                    <div class="station-info">
                        <div class="station-name">Ga Lào Cai</div>
                        <div class="time">14:10</div>
                        <div class="date-display">24 tháng 03</div>
                    </div>
                </div>

                <div class="col-md-2">
                    <div class="price-section">
                        <div class="price-label">Từ</div>
                        <div class="price">225.000 VND</div>
                    </div>
                </div>

                <div class="col-md-2">
                    <button class="btn btn-select-seat" data-toggle="modal" data-target="#seatSelectionModal" data-train="SP3">Chọn chỗ</button>
                </div>
            </div>
        </div>

        <!-- SP1 Train Option -->
        <div class="train-option">
            <div class="row">
                <div class="col-md-2">
                    <div class="train-details">
                        <div class="train-type">Tàu chất lượng cao</div>
                        <div class="train-code">SP1</div>
                        <div class="seats-available">Còn 92 chỗ</div>
                    </div>
                </div>

                <div class="col-md-2">
                    <div class="station-info">
                        <div class="station-name">Ga Hà Nội</div>
                        <div class="time">21:35</div>
                        <div class="date-display">24 tháng 03</div>
                    </div>
                </div>

                <div class="col-md-2">
                    <div class="journey-visualization">
                        <div class="duration">7h55p</div>
                        <div class="arrow">→</div>
                    </div>
                </div>

                <div class="col-md-2">
                    <div class="station-info">
                        <div class="station-name">Ga Lào Cai</div>
                        <div class="time">05:30</div>
                        <div class="date-display">25 tháng 03</div>
                    </div>
                </div>

                <div class="col-md-2">
                    <div class="price-section">
                        <div class="price-label">Từ</div>
                        <div class="price">279.000 VND</div>
                    </div>
                </div>

                <div class="col-md-2">
                    <button class="btn btn-select-seat" data-toggle="modal" data-target="#seatSelectionModal" data-train="SP1">Chọn chỗ</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Seat Selection Modal -->
<div class="modal fade" id="seatSelectionModal" tabindex="-1" role="dialog" aria-labelledby="seatSelectionModalLabel">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="seatSelectionModalLabel">Ga Hà Nội → Ga Lào Cai | <span id="modalDate"></span></h4>
            </div>
            <div class="modal-body">
                <h4 class="text-center" id="modalTrainCode">Tàu Tốc Hành</h4>

                <!-- Coach selection -->
                <div class="coach-selection">
                    <div class="coach-option" data-coach="coach2">
                        <div class="coach-title">Toa 2: Giường nằm khoang 4 điều hòa</div>
                        <div class="coach-details">Giá từ 1298K - 1435K</div>
                    </div>
                    <div class="coach-option" data-coach="coach4">
                        <div class="coach-title">Toa 4: Giường nằm khoang 6 điều hòa</div>
                        <div class="coach-details">Còn 25 chỗ | Giá từ 1055K - 1235K</div>
                    </div>
                    <div class="coach-option active" data-coach="coach3">
                        <div class="coach-title">Toa 3: Giường nằm khoang 6 điều hòa</div>
                        <div class="coach-details">Còn 19 chỗ | Giá từ 1053K - 1235K</div>
                    </div>
                    <div class="coach-option" data-coach="coach1">
                        <div class="coach-title">Toa 1: Ngồi mềm điều hòa</div>
                        <div class="coach-details">Còn 54 chỗ | Giá từ 797K - 817K</div>
                    </div>
                </div>

                <!-- Coach 3 content (active by default) -->
                <div class="coach-content active" id="coach3">
                    <h4 class="compartment-title">Toa 3: Giường nằm khoang 6 điều hòa</h4>
                    <div class="tab-content">
                        <div class="tab-pane active">
                            <div class="compartment-container">
                                <div class="floor-label-container">
                                    <div class="floor-labels">
                                        <div class="floor-label">Tầng 3</div>
                                        <div class="floor-label">Tầng 2</div>
                                        <div class="floor-label">Tầng 1</div>
                                    </div>
                                </div>

                                <div class="compartment-layout">
                                    <div class="berth-column">
                                        <div class="berth-content">Khoang 1</div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">5</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">6</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">3</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat sold">
                                                <div class="seat-number">4</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">1</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat sold">
                                                <div class="seat-number">2</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="berth-column">
                                        <div class="berth-content">Khoang 2</div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">11</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">12</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">9</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat sold">
                                                <div class="seat-number">10</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">7</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">8</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="berth-column">
                                        <div class="berth-content">Khoang 3</div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">17</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">18</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">15</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat sold">
                                                <div class="seat-number">16</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">13</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat sold">
                                                <div class="seat-number">14</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="berth-column">
                                        <div class="berth-content">Khoang 4</div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">23</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">24</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">21</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat sold">
                                                <div class="seat-number">22</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">19</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat sold">
                                                <div class="seat-number">20</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="berth-column">
                                        <div class="berth-content">Khoang 5</div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">29</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">30</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">27</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">28</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">25</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">26</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="berth-column">
                                        <div class="berth-content">Khoang 6</div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">35</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">36</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">33</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">34</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">31</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">32</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="berth-column">
                                        <div class="berth-content">Khoang 7</div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">41</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">42</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">39</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">40</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">37</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">38</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Other coach content -->
                <div class="coach-content" id="coach2">
                    <h4 class="compartment-title">Toa 2: Giường nằm khoang 4 điều hòa</h4>
                    <div class="tab-content">
                        <div class="tab-pane active">
                            <div class="compartment-container">
                                <div class="floor-label-container">
                                    <div class="floor-labels">
                                        <div class="floor-label">Tầng 2</div>
                                        <div class="floor-label">Tầng 1</div>
                                    </div>
                                </div>

                                <div class="compartment-layout">
                                    <div class="berth-column">
                                        <div class="berth-content">Khoang 1</div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">3</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat sold">
                                                <div class="seat-number">4</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">1</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat sold">
                                                <div class="seat-number">2</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="berth-column">
                                        <div class="berth-content">Khoang 2</div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">9</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat sold">
                                                <div class="seat-number">10</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">7</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">8</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="berth-column">
                                        <div class="berth-content">Khoang 3</div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">15</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat sold">
                                                <div class="seat-number">16</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">13</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat sold">
                                                <div class="seat-number">14</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="berth-column">
                                        <div class="berth-content">Khoang 4</div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">21</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat sold">
                                                <div class="seat-number">22</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">19</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat sold">
                                                <div class="seat-number">20</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="berth-column">
                                        <div class="berth-content">Khoang 5</div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">27</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">28</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">25</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">26</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="berth-column">
                                        <div class="berth-content">Khoang 6</div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">33</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">34</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">31</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">32</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="berth-column">
                                        <div class="berth-content">Khoang 7</div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">39</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">40</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">37</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">38</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="coach-content" id="coach4">
                    <h4 class="compartment-title">Toa 4: Giường nằm khoang 6 điều hòa</h4>
                    <div class="tab-content">
                        <div class="tab-pane active">
                            <div class="compartment-container">
                                <div class="floor-label-container">
                                    <div class="floor-labels">
                                        <div class="floor-label">Tầng 3</div>
                                        <div class="floor-label">Tầng 2</div>
                                        <div class="floor-label">Tầng 1</div>
                                    </div>
                                </div>

                                <div class="compartment-layout">
                                    <div class="berth-column">
                                        <div class="berth-content">Khoang 1</div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">5</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">6</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">3</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat sold">
                                                <div class="seat-number">4</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">1</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat sold">
                                                <div class="seat-number">2</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="berth-column">
                                        <div class="berth-content">Khoang 2</div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">11</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">12</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">9</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat sold">
                                                <div class="seat-number">10</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">7</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">8</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="berth-column">
                                        <div class="berth-content">Khoang 3</div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">17</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">18</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">15</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat sold">
                                                <div class="seat-number">16</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">13</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat sold">
                                                <div class="seat-number">14</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="berth-column">
                                        <div class="berth-content">Khoang 4</div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">23</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">24</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">21</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat sold">
                                                <div class="seat-number">22</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">19</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat sold">
                                                <div class="seat-number">20</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="berth-column">
                                        <div class="berth-content">Khoang 5</div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">29</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">30</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">27</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">28</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">25</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">26</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="berth-column">
                                        <div class="berth-content">Khoang 6</div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">35</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">36</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">33</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">34</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">31</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">32</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="berth-column">
                                        <div class="berth-content">Khoang 7</div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">41</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">42</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">39</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">40</div>
                                                <div class="seat-price">1161K</div>
                                            </div>
                                        </div>
                                        <div class="berth-row">
                                            <div class="seat available">
                                                <div class="seat-number">37</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                            <div class="seat available">
                                                <div class="seat-number">38</div>
                                                <div class="seat-price">1054K</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="coach-content" id="coach1">
                    <h4 class="compartment-title">Toa 1: Ngồi mềm điều hòa</h4>
                    <div class="seated-coach-container">
                        <div class="seat-layout">
                            <!-- Hàng ghế bên trái -->
                            <div class="seat-column left-side">
                                <div class="seat-row">
                                    <div class="seat available">
                                        <div class="seat-number">1</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">2</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">3</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">4</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">5</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">6</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">7</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">8</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                </div>
                                <div class="seat-row">
                                    <div class="seat available">
                                        <div class="seat-number">17</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">18</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">19</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">20</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">21</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">22</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">23</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">24</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                </div>
                                <div class="seat-row">
                                    <div class="seat available">
                                        <div class="seat-number">33</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">34</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">35</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">36</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">37</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">38</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">39</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">40</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                </div>
                                <div class="seat-row">
                                    <div class="seat available">
                                        <div class="seat-number">49</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">50</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">51</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">52</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">53</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">54</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">55</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">56</div>
                                        <div class="seat-price">888K</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Bàn ngăn cách -->
                            <div class="table-container">
                                <div class="table-separator-1">
                                    <div class="table-label">Bàn</div>
                                </div>
                                <div class="table-separator-2">
                                    <div class="table-label">Bàn</div>
                                </div>
                            </div>

                            <!-- Hàng ghế bên phải -->
                            <div class="seat-column right-side">
                                <div class="seat-row">
                                    <div class="seat available">
                                        <div class="seat-number">9</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">10</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">11</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">12</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">13</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">14</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">15</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">16</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                </div>
                                <div class="seat-row">
                                    <div class="seat available">
                                        <div class="seat-number">25</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">26</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">27</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">28</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">29</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">30</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">31</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">32</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                </div>
                                <div class="seat-row">
                                    <div class="seat available">
                                        <div class="seat-number">41</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">42</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">43</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">44</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">45</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">46</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">47</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">48</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                </div>
                                <div class="seat-row">
                                    <div class="seat available">
                                        <div class="seat-number">57</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">58</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">59</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">60</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">61</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">62</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">63</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                    <div class="seat available">
                                        <div class="seat-number">64</div>
                                        <div class="seat-price">904K</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Legend for seat status -->
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-box legend-available"></div>
                        <span>Còn trống</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-box legend-selected"></div>
                        <span>Đang chọn</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-box legend-sold"></div>
                        <span>Đã bán</span>
                    </div>
                </div>

                <!-- Selected passengers info -->
                <div id="selected-passengers" class="selected-passengers">
                    <!-- Selected seats will appear here -->
                </div>

                <!-- Customer note -->
                <div class="customer-note">
                    <p><i class="fa fa-info-circle"></i> Quý khách vui lòng chọn chỗ mong muốn để tiến hành đặt vé.</p>
                </div>

                <!-- Checkout bar -->
                <div class="checkout-bar">
                    <div class="seat-count">
                        Đã chọn: <span id="selected-count">0</span> chỗ
                    </div>
                    <button type="button" class="btn btn-primary" id="btn-proceed">
                        Tiếp tục <i class="fa fa-arrow-right"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
            document.addEventListener('DOMContentLoaded', function() {
                // Trip type toggle
                const oneWayBtn = document.getElementById('oneWay');
                const roundTripBtn = document.getElementById('roundTrip');
                const returnDateInput = document.getElementById('returnDate');

                oneWayBtn.addEventListener('click', function() {
                    oneWayBtn.classList.add('active');
                    roundTripBtn.classList.remove('active');
                    returnDateInput.disabled = true;
                    returnDateInput.placeholder = 'Chọn nếu mua vé về';
                });

                roundTripBtn.addEventListener('click', function() {
                    roundTripBtn.classList.add('active');
                    oneWayBtn.classList.remove('active');
                    returnDateInput.disabled = false;
                    returnDateInput.placeholder = 'Chọn ngày về';
                });

                // Swap stations
                const swapStationsBtn = document.getElementById('swapStations');
                swapStationsBtn.addEventListener('click', function() {
                    const departureStation = document.getElementById('departureStation');
                    const arrivalStation = document.getElementById('arrivalStation');
                    const tempValue = departureStation.value;

                    departureStation.value = arrivalStation.value;
                    arrivalStation.value = tempValue;
                });

                // Initialize date selector
                initializeDateSelector();

                // Date scrolling
                const leftScrollBtn = document.querySelector('.date-scroll-btn.left');
                const rightScrollBtn = document.querySelector('.date-scroll-btn.right');
                const dateOptionsContainer = document.querySelector('.date-options');

                leftScrollBtn.addEventListener('click', function() {
                    dateOptionsContainer.scrollBy({ left: -360, behavior: 'smooth' });
                });

                rightScrollBtn.addEventListener('click', function() {
                    dateOptionsContainer.scrollBy({ left: 360, behavior: 'smooth' });
                });

                // Go to selected month/year
                const goToDateBtn = document.getElementById('goToDateBtn');
                goToDateBtn.addEventListener('click', function() {
                    const selectedMonth = parseInt(document.getElementById('monthSelector').value);
                    const selectedYear = parseInt(document.getElementById('yearSelector').value);
                    scrollToMonthYear(selectedMonth, selectedYear);
                });

                // Update modal content when opened
                $('.btn-select-seat').on('click', function() {
                    const trainCode = $(this).data('train');
                    const dateDisplay = $(this).closest('.train-option').find('.date-display').first().text();
                    $('#modalTrainCode').text('Tàu Tốc Hành ' + trainCode);
                    $('#modalDate').text(dateDisplay);
                });
            });

            // Initialize date selector with full year of dates
            function initializeDateSelector() {
                const dateContainer = document.getElementById('dateOptions');
                const today = new Date();

                // Fill month selector
                const monthSelector = document.getElementById('monthSelector');
                const months = [
                    'Tháng 1', 'Tháng 2', 'Tháng 3', 'Tháng 4', 'Tháng 5', 'Tháng 6',
                    'Tháng 7', 'Tháng 8', 'Tháng 9', 'Tháng 10', 'Tháng 11', 'Tháng 12'
                ];

                monthSelector.innerHTML = '';
                for (let i = 0; i < months.length; i++) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = months[i];
                    if (i === today.getMonth()) {
                        option.selected = true;
                    }
                    monthSelector.appendChild(option);
                }

                // Fill year selector
                const yearSelector = document.getElementById('yearSelector');
                yearSelector.innerHTML = '';
                const currentYear = today.getFullYear();

                for (let year = currentYear; year <= currentYear + 2; year++) {
                    const option = document.createElement('option');
                    option.value = year;
                    option.textContent = year;
                    if (year === currentYear) {
                        option.selected = true;
                    }
                    yearSelector.appendChild(option);
                }

                // Create date options for the full year
                createDatesForYear(dateContainer, today);

                // Scroll to today's date
                const todayElement = dateContainer.querySelector('.date-option.active');
                if (todayElement) {
                    todayElement.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
                }
            }

            // Create date options for the full year
            function createDatesForYear(container, today) {
                container.innerHTML = '';
                const currentYear = today.getFullYear();

                // Get the selected depart date to highlight
                const departDateInput = document.getElementById('departDate');
                let selectedDate = departDateInput.value ? new Date(departDateInput.value.split('-').reverse().join('-')) : today;

                // Get the days of the week in Vietnamese
                const days = ['Chủ Nhật', 'Thứ 2', 'Thứ 3', 'Thứ 4', 'Thứ 5', 'Thứ 6', 'Thứ 7'];

                // Create date options for the entire year
                const startDate = new Date(currentYear, 0, 1);
                const endDate = new Date(currentYear + 1, 11, 31);

                let current = new Date(startDate);
                current.setHours(0, 0, 0, 0);

                while (current <= endDate) {
                    const dateOption = document.createElement('div');
                    dateOption.className = 'date-option';

                    // Convert date to dd-mm-yyyy format
                    const formattedDate = formatDate(current);

                    // Get day name in Vietnamese
                    const dayName = days[current.getDay()];

                    dateOption.innerHTML = `
                        <div class="date">${formattedDate}</div>
                        <div class="day">${dayName}</div>
                    `;

                    // Set data attribute for date
                    dateOption.dataset.date = current.toISOString();

                    // Check if this is the selected date
                    if (current.toDateString() === selectedDate.toDateString()) {
                        dateOption.classList.add('active');
                    }

                    // Set click event
                    dateOption.addEventListener('click', function() {
                        // Remove active class from all dates
                        const activeDates = container.querySelectorAll('.date-option.active');
                        activeDates.forEach(date => date.classList.remove('active'));

                        // Add active class to clicked date
                        this.classList.add('active');

                        // Update depart date input
                        document.getElementById('departDate').value = formatDate(new Date(this.dataset.date));
                    });

                    // Add to container
                    container.appendChild(dateOption);

                    // Move to next day
                    current.setDate(current.getDate() + 1);
                }
            }

            // Format date as dd-mm-yyyy
            function formatDate(date) {
                const day = String(date.getDate()).padStart(2, '0');
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const year = date.getFullYear();
                return `${day}-${month}-${year}`;
            }

            // Scroll to a specific month and year
            function scrollToMonthYear(month, year) {
                const dateOptions = document.querySelectorAll('.date-option');

                for (let i = 0; i < dateOptions.length; i++) {
                    const dateStr = dateOptions[i].dataset.date;
                    const date = new Date(dateStr);

                    if (date.getMonth() === month && date.getFullYear() === year) {
                        dateOptions[i].scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'start' });
                        break;
                    }
                }
            }

            // Passenger count handling
            document.addEventListener('DOMContentLoaded', function() {
                const passengerInput = document.getElementById('passengerCount');
                const increaseBtn = document.getElementById('increasePassenger');
                const decreaseBtn = document.getElementById('decreasePassenger');

                increaseBtn.addEventListener('click', function() {
                    let currentValue = parseInt(passengerInput.value);
                    if (currentValue < 10) {
                        passengerInput.value = currentValue + 1;
                    }
                });

                decreaseBtn.addEventListener('click', function() {
                    let currentValue = parseInt(passengerInput.value);
                    if (currentValue > 1) {
                        passengerInput.value = currentValue - 1;
                    }
                });
            });

        $(document).ready(function() {
        // Global variables
        var selectedSeats = [];
        var maxSeats = 5; // Maximum number of seats a customer can book at once

        // Initialize components
        updateSelectedCount();
        updateCheckoutButton();

        // Coach selection
        $('.coach-option').click(function() {
            var coachId = $(this).data('coach');

            // Update active coach option
            $('.coach-option').removeClass('active');
            $(this).addClass('active');

            // Show related coach content
            $('.coach-content').removeClass('active');
            $('#' + coachId).addClass('active');

            // Clear selected seats when changing coach
            clearSelectedSeats();
        });

        // Seat selection
        $(document).on('click', '.seat.available', function() {
            var seatNumber = $(this).find('.seat-number').text();
            var seatPrice = $(this).find('.seat-price').text();
            var currentCoach = $('.coach-content.active').attr('id');

            // Check if the seat is already selected
            if ($(this).hasClass('selected')) {
                // Remove seat from selection
                removeSeat(seatNumber);
                $(this).removeClass('selected');
                if (selectedSeats.length === 0) {
                    $('.customer-note').show();
                }
            } else {
                // Check if maximum seats already selected
                if (selectedSeats.length >= maxSeats) {
                    showNotification('Quý khách chỉ được chọn tối đa ' + maxSeats + ' chỗ ngồi', 'warning');
                    return;
                }

                // Add seat to selection
                $(this).addClass('selected');
                addSeat(seatNumber, seatPrice, currentCoach);

                // Hide the customer note when a seat is selected
                $('.customer-note').hide();
            }

            updateSelectedCount();
            updateCheckoutButton();
        });

        // Remove seat when clicking on X button
        $(document).on('click', '.remove-seat', function() {
            var seatNumber = $(this).data('seat');

            // Find and unselect seat in UI
            var seatElement = $('.seat.selected .seat-number:contains("' + seatNumber + '")').closest('.seat');
            if (seatElement.length) {
                seatElement.removeClass('selected');
            }

            // Remove seat from selected list
            removeSeat(seatNumber);

            // Update count and button state
            updateSelectedCount();
            updateCheckoutButton();

            // Show customer note if no seats selected
            if (selectedSeats.length === 0) {
                $('.customer-note').show();
            }
        });

        // Proceed to next step
        $('#btn-proceed').click(function() {
            if (selectedSeats.length === 0) {
                showNotification('Vui lòng chọn ít nhất 1 chỗ ngồi', 'warning');
                return;
            }

            // Show confirmation
            var totalPrice = calculateTotalPrice();
            showNotification('Đã chọn ' + selectedSeats.length + ' chỗ với tổng tiền ' + totalPrice, 'success');
        });

        // Helper functions
        function addSeat(seatNumber, seatPrice, coach) {
            // Get coach name from the coach content title
            var coachName = $('#' + coach + ' .compartment-title').text();

            // Add to selected seats array
            selectedSeats.push({
                number: seatNumber,
                price: seatPrice,
                coach: coach,
                coachName: coachName
            });

            // Add to UI
            var seatHtml = [
                '<div class="selected-passenger" id="passenger-' + seatNumber + '">',
                    '<div class="passenger-info">',
                        '<span class="seat-tag">Chỗ ' + seatNumber + '</span>',
                        '<span>' + getCompartmentInfo(seatNumber, coach) + '</span>',
                    '</div>',
                    '<div class="d-flex align-items-center">',
                        '<span class="price-tag mr-3">' + seatPrice + '</span>',
                        '<i class="fa fa-times remove-seat" data-seat="' + seatNumber + '"></i>',
                    '</div>',
                '</div>'
            ].join('');

            $('#selected-passengers').append(seatHtml);
        }

        function removeSeat(seatNumber) {
            // Remove from UI
            $('#passenger-' + seatNumber).remove();

            // Remove from array
            selectedSeats = selectedSeats.filter(function(seat) {
                return seat.number !== seatNumber.toString();
            });
        }

        function clearSelectedSeats() {
            // Clear array
            selectedSeats = [];

            // Clear UI
            $('#selected-passengers').empty();

            // Unselect all seats
            $('.seat').removeClass('selected');

            // Show customer note
            $('.customer-note').show();

            updateSelectedCount();
            updateCheckoutButton();
        }

        function updateSelectedCount() {
            $('#selected-count').text(selectedSeats.length);
        }

        function updateCheckoutButton() {
            if (selectedSeats.length > 0) {
                $('#btn-proceed').removeClass('disabled');
            } else {
                $('#btn-proceed').addClass('disabled');
            }
        }

        function calculateTotalPrice() {
            var total = 0;
            selectedSeats.forEach(function(seat) {
                var priceValue = parseInt(seat.price.replace('K', '')) * 1000;
                total += priceValue;
            });

            return new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(total);
        }

        function getCompartmentInfo(seatNumber, coach) {
            var coachName = $('#' + coach + ' .compartment-title').text().split(':')[0];
            var compartmentNumber = '';

            if (coach === 'coach3' || coach === 'coach4') {
                var seatNum = parseInt(seatNumber);
                if (seatNum <= 6) compartmentNumber = '1';
                else if (seatNum <= 12) compartmentNumber = '2';
                else if (seatNum <= 18) compartmentNumber = '3';
                else if (seatNum <= 24) compartmentNumber = '4';
                else if (seatNum <= 30) compartmentNumber = '5';
                else if (seatNum <= 36) compartmentNumber = '6';
                else if (seatNum <= 42) compartmentNumber = '7';
                return coachName + ', Khoang ' + compartmentNumber;
            } else if (coach === 'coach2') {
                var seatNum = parseInt(seatNumber);
                compartmentNumber = Math.ceil(seatNum / 4).toString();
                return coachName + ', Khoang ' + compartmentNumber;
            } else if (coach === 'coach1') {
                return coachName + ', Chỗ ngồi ' + seatNumber;
            }

            return coachName;
        }

        function showNotification(message, type) {
            var alertClass = type === 'warning' ? 'alert-warning' : 'alert-success';
            var notification = $(
                '<div class="alert ' + alertClass + ' alert-dismissible" role="alert">' +
                    '<button type="button" class="close" data-dismiss="alert" aria-label="Close">' +
                        '<span aria-hidden="true">&times;</span>' +
                    '</button>' +
                    message +
                '</div>'
            );

            notification.css({
                'position': 'fixed',
                'top': '20px',
                'right': '20px',
                'z-index': '9999',
                'max-width': '300px'
            });

            $('body').append(notification);

            setTimeout(function() {
                notification.fadeOut(function() {
                    $(this).remove();
                });
            }, 5000);
        }

        // Keyboard navigation for seats
        $(document).keydown(function(e) {
            if ($('.seat:focus').length) {
                var focusedSeat = $('.seat:focus');
                var nextSeat;
                var currentCoach = $('.coach-content.active').attr('id');

                if (currentCoach === 'coach1') {
                    var seatRow = focusedSeat.closest('.seat-row');
                    var seatColumn = focusedSeat.closest('.seat-column');
                    var seatIndex = focusedSeat.index();
                    var rowIndex = seatRow.index();
                    var isLeftSide = seatColumn.hasClass('left-side');

                    switch(e.keyCode) {
                        case 37: // Left arrow
                            nextSeat = focusedSeat.prev('.seat');
                            break;
                        case 39: // Right arrow
                            nextSeat = focusedSeat.next('.seat');
                            if (!nextSeat.length && isLeftSide && seatIndex === 7) {
                                // Jump to right-side, same row
                                nextSeat = seatColumn.nextAll('.right-side').find('.seat-row').eq(rowIndex).find('.seat').first();
                            }
                            break;
                        case 38: // Up arrow
                            if (rowIndex > 0) {
                                nextSeat = seatRow.prev('.seat-row').find('.seat').eq(seatIndex);
                            }
                            break;
                        case 40: // Down arrow
                            nextSeat = seatRow.next('.seat-row').find('.seat').eq(seatIndex);
                            break;
                        case 13: // Enter key - select seat
                            if (focusedSeat.hasClass('available')) {
                                focusedSeat.click();
                            }
                            break;
                    }
                } else {
                    switch(e.keyCode) {
                        case 37: // Left arrow
                            nextSeat = focusedSeat.prev('.seat');
                            break;
                        case 38: // Up arrow
                            var currentIndex = focusedSeat.index();
                            nextSeat = focusedSeat.parent().prev('.berth-row').children('.seat').eq(currentIndex);
                            break;
                        case 39: // Right arrow
                            nextSeat = focusedSeat.next('.seat');
                            break;
                        case 40: // Down arrow
                            var idx = focusedSeat.index();
                            nextSeat = focusedSeat.parent().next('.berth-row').children('.seat').eq(idx);
                            break;
                        case 13: // Enter key - select seat
                            if (focusedSeat.hasClass('available')) {
                                focusedSeat.click();
                            }
                            break;
                    }
                }

                if (nextSeat && nextSeat.length) {
                    nextSeat.focus();
                    e.preventDefault();
                }
            }
        });

        // Make seats focusable
        $('.seat').attr('tabindex', '0');

        // Mobile detection
        function isMobile() {
            return window.innerWidth <= 768;
        }

        // Adjust UI for mobile
        function adjustForMobile() {
            if (isMobile()) {
                $('.coach-selection').css('flex-direction', 'column');
            } else {
                $('.coach-selection').css('flex-direction', '');
            }
        }

        // Call on load and resize
        adjustForMobile();
        $(window).resize(adjustForMobile);

        // Smooth scrolling to selected seat
        function scrollToSelectedSeat() {
            if (selectedSeats.length > 0) {
                var lastSeat = selectedSeats[selectedSeats.length - 1];
                var seatElement = $('.seat .seat-number:contains(' + lastSeat.number + ')').closest('.seat');

                if (seatElement.length) {
                    $('html, body').animate({
                        scrollTop: seatElement.offset().top - 100
                    }, 500);
                }
            }
        }

        $(document).on('click', '.seat.available', function() {
            setTimeout(scrollToSelectedSeat, 100);
        });
    });
</script>